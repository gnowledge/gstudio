{% extends "ndf/base.html" %}
{% load i18n %}
{% load ndf_tags %}
{% load pagination_tags %}
{% get_group_name groupid as group_name_tag %}

{% block style %}

	.right-border{
		border-right: 1px solid #dddddd
	}

	.bottom-border > th {
		border-bottom: 1px solid #f1f1f1;
	}

	article.columns{
		padding-bottom: 0;
		margin-bottom: 2em;
	}

	.expand-width-8{
		padding: 0 8em;
	}

	.expand-width-6{
		padding: 0 6em;
	}

	.expand-width-3{
		padding: 0 3em;
	}

	.expand-width-2{
		padding: 0 2em;
	}

	.expand-width-1{
		padding: 0 1em;
	}

	.hide-el input, .hide-el select{
		display: none;
	}

	.show-el input, .show-el select{
		display: block;
	}
	
{% endblock %}

{% block body_content %}

<br/>

<table style="width:auto">
<!-- <table> -->
	<thead>
		<tr>
			<th class="text-center right-border" colspan="5">Autogenerated</th>
			<th class="text-center right-border" colspan="5">Base</th>
			<th class="text-center right-border" colspan="7">Attribution</th>
			<th class="text-center right-border" colspan="2">LRMI</th>
			<th class="text-center right-border" colspan="3">Alignment & Level</th>
			<th class="text-center right-border" colspan="7">Curate</th>
			<th class="text-center right-border" colspan="3">Advance</th>
		</tr>
		<tr class="bottom-border">

			<!-- Autogenerated -->
			<th>Id</th>
			<th class="expand-width-3">Creation date</th>
			<th>Modified by</th>
			<th>Author</th>
			<th class="right-border">Contributors</th>

			<!-- Base -->
			<th class="expand-width-6">Name</th>
			<th class="expand-width-3">Altname</th>
			<th class="expand-width-6">content_org</th>
			<th class="expand-width-2">Language</th>
			<th class="right-border">tags</th>

			<!-- Attribution -->
			<th class="expand-width-3">Created by</th>
			<th class="expand-width-3">Contributed by</th>
			<th class="expand-width-3">License</th>
			<th class="expand-width-3">Source</th>
			<th>Basenodeurl</th>
			<th>Translation of</th>
			<th class="right-border">Adaption of</th>

			<!-- LRMI -->
			<th class="expand-width-3">Educational use</th>
			<th class="right-border expand-width-2">Interactivity Type</th>

			<!-- Alignment and Level -->
			<th class="expand-width-1">Alignment</th>
			<th class="expand-width-8">Educational Level</th>
			<th class="right-border expand-width-3">Educational Subject</th>

			<!-- Curate -->
			<th class="expand-width-1">Curricular</th>
			<th class="expand-width-8">Audience</th>
			<th class="expand-width-2">Teaches</th>
			<th class="expand-width-2">Requires</th>
			<th class="expand-width-2">Featured</th>
			<th class="expand-width-3">Status</th>
			<th class="expand-width-3 right-border">Acess Policy</th>

			<!-- Advance -->
			<th class="expand-width-3">Reading Level</th>
			<th class="expand-width-3">Time Required</th>
			<th class="expand-width-3">Text Complexity</th>

		</tr>

	</thead>
	<tbody>
		<!-- Looping through each resource -->
		{% for resource in files %}
		<tr id="view-row-{{resource.pk}}">

			<!-- Autogenerated -->
			<td class="view">{{ resource.pk }}</td>
			<td class="view">{{ resource.created_at }}</td>
			<td class="view">{{ resource.user_details_dict.modified_by }}</td>
			<td class="view">{{ resource.user_details_dict.created_by }}</td>
			<td class="view right-border">{{ resource.user_details_dict.contributors | join:", " }}</td>
			
			<!-- Base -->
			<td class="view">{{ resource.name }}</td>
			<td class="view">{{ resource.altnames }}</td>
			<td class="view" title="{{ resource.content_org }}">{{ resource.content_org | truncatechars:60 }}</td>
			<td class="view">{{ resource.language }}</td>
			<td class="view right-border"> {{resource.tags|safeseq|join:", "}} </td>

			<!-- Attribution -->
			<td class="view">{{ resource.creator }}</td>
			<td class="view">{{ resource.other_contributors }}</td>
			<td class="view">{{ resource.licence }}</td>
			<td class="view">{{ resource.source }}</td>
			<td class="view">{{ resource.basedonurl }}</td>
			<td class="view">{{ resource.translation_of }}</td>
			<td class="view right-border">{{ resource.adaption_of }}</td>

			<!-- LRMI -->
			<td class="view">{{ resource.educationaluse }}</td>
			<td class="view right-border">{{ resource.interactivitytype }}</td>

			<!-- Alignment and Level -->
			<td class="view">{{ resource.educationalalignment }}</td>
			<td class="view">{{ resource.educationallevel }}</td>
			<td class="view right-border">{{ resource.educationalsubject }}</td>

			<!-- Curate -->
			<td class="view">{{ resource.curricular }}</td>
			<td class="view">{{ resource.audience }}</td>
			<td class="view">
				{% for each_teaches in resource.teaches %}
					{{ each_teaches.name }}
				{% endfor %}
			</td>
			<td class="view"><!-- prior_node processing -->
				{% for index_key, each_node in resource.prior_node_dict.items %}
					{{ each_node.name }}
				{% endfor %}
			</td>
			<td class="view">{{ resource.featured }}</td>
			<td class="view">{{ resource.status }}</td>
			<td class="view right-border">{{ resource.access_policy }}</td>

			<!-- Advance -->
			<td class="view">{{ resource.readinglevel }}</td>
			<td class="view">{{ resource.timerequired }}</td>
			<td class="right-border">{{ resource.textcomplexity }}</td>
			
		</tr>
		<tr></tr>
		
		<tr id="edit-row-{{resource.pk}}">
			
			<!-- Autogenerated -->
			<td class="right-border" colspan="5">
				<div class="button tiny expand" data-id="edit-btn-{{resource.pk}}" onclick="editResRow('{{resource.pk}}')">
					Edit
				</div>
				<div class="row" style="display:none;" data-id="save-cancel-div-{{resource.pk}}">
					<span class="small-push-1 small-4 columns button tiny" data-id="save-btn-{{resource.pk}}">
						Save
					</span>
					<span class="small-pull-1 small-4 columns button tiny" data-id="cancel-btn-{{resource.pk}}" onclick="CancelEditResRow('{{resource.pk}}')">
						Cancel
					</span>
				</div>
			</td>

			<!-- Base -->
			<td class="hide-el" data-field="name"><input type="text" value="{{ resource.name }}" /></td>
			<td class="hide-el" data-field="altnames"><input type="text" value="{{ resource.altnames }}" /></td>
			<td class="hide-el" data-field="content_org">
				<input type="button" class="button tiny expand" value="Edit content in editor" data-content-org="{{ resource.content_org }}" />
			</td>
			<td class="hide-el" data-field="language">
				<select name="language">
					{% for each_lang in static_language %}
						<option {%if each_lang|lower == resource.language|lower %}selected="selected"{%endif%} value="{{ each_lang }}">{{ each_lang }}</option>
					{% endfor %}
					
					{% comment %}
					<!-- <option {%if resource.language|lower == "english" %}selected="selected"{%endif%} value="English">English</option>
					<option {%if resource.language|lower == "hindi" %}selected="selected"{%endif%} value="Hindi">Hindi</option> -->
					<!-- {% for lang_code, lang_info in static_language.items %}
						<option {%if lang_info.name == resource.language %}selected="selected"{%endif%} value="{{ lang_info.name }}">{{ lang_info.name }}</option>
					{% endfor %} -->
					{% endcomment %}
				</select>
			</td>
			<td class="hide-el right-border" data-field="tags"><input type="text" value='{{resource.tags|safeseq|join:", "}}' />
			</td>

			<!-- Attribution -->
			<td class="hide-el" data-field="created_by"><input type="text" value="{{ resource.creator }}" /></td>
			<td class="hide-el" data-field="contributors"><input type="text" value="{{ resource.other_contributors }}" /></td>
			<td class="hide-el" data-field="license"><input type="text" value="{{ resource.licence }}" /></td>
			<td class="hide-el" data-field="source"><input type="text" value="{{ resource.source }}" /></td>
			<td class="hide-el" data-field="basenodeurl"><input type="text" value="{{ resource.basedonurl }}" /></td>
			<td class="hide-el" data-field="translation_of"></td>
			<td class="hide-el right-border" data-field="adaptation_of" ><input type="text" value="{{ resource.adaption_of }}" /></td>

			<!-- LRMI -->
			<!-- <td class="view">{{ resource.educationaluse }}</td> -->
			<!-- <td class="view right-border">{{ resource.interactivitytype }}</td> -->

			<!-- LRMI -->
			<td class="hide-el" data-field="educationaluse">
				<select name="educationaluse">
					{% for each_edu_use in static_educationaluse %}
						<option {%if each_edu_use == resource.educationaluse %}selected="selected"{%endif%} value="{{ each_edu_use }}">
							{{ each_edu_use }}
						</option>
					{% endfor %}
				</select>
			</td>
			<td class="hide-el right-border" data-field="interactivitytype">
				<select name="interactivitytype">
					{% for each_intertype in static_interactivitytype %}
						<option {%if each_intertype == resource.interactivitytype %}selected="selected"{%endif%} value="{{ each_intertype }}">{{ each_intertype }}</option>
					{% endfor %}
				</select>
			</td>

			<!-- Alignment and Level -->
			<td class="hide-el" data-field="educationalalignment">
				<select name="educationalalignment">
					{% for each_edu_align in static_educationalalignment %}
						<option {%if each_edu_align == resource.educationalalignment %}selected="selected"{%endif%} value="{{ each_edu_align }}">{{ each_edu_align }}</option>
					{% endfor %}
				</select>
			</td>
			<td class="hide-el" data-field="educationallevel">
				<select name="educationallevel">
					{% for each_edulevel in static_educationallevel %}
						<option {%if each_edulevel == resource.educationallevel %}selected="selected"{%endif%} value="{{ each_edulevel }}">{{ each_edulevel }}</option>
					{% endfor %}
				</select>
			</td>
			<td class="hide-el right-border" data-field="educationalsubject">
				<select name="educationalsubject">
				{% for each_sub in static_educationalsubject %}
					<option {%if each_sub == resource.educationalsubject %}selected="selected"{%endif%} value="{{each_sub}}">{{ each_sub }}</option>
				{% endfor %}
				</select>
			</td>

			<!-- Curate -->
			<td class="hide-el" data-field="curricular">
				<select name="curricular">
				{% for each_curr in static_curricular %}		
					<option {%if each_curr == resource.curricular %}selected="selected"{%endif%} value="{{ each_curr }}">{{ each_curr }}</option>
				{% endfor %}
				</select>
			</td>
			<td class="hide-el" data-field="audience">
				<select name="audience">
				{% for each_aud in static_audience %}		
					<option {%if each_aud == resource.audience %}selected="selected"{%endif%} value="{{ each_aud }}">{{ each_aud }}</option>
				{% endfor %}
				</select>
			</td>
			<td class="hide-el" data-field="teaches"></td>
			<td class="hide-el" data-field="prior_node"></td>
			<td class="hide-el" data-field="featured">
				<select name="featured">
					<option value="False">False</option>
					<option value="True">True</option>
				</select>
			</td>
			<td class="hide-el" data-field="status">
				<select name="status">
				{% for each_status in static_status %}		
					<option {%if each_status == resource.status %}selected="selected"{%endif%} value="{{ each_status }}">{{ each_status }}</option>
				{% endfor %}	
				</select>
			</td>
			<td class="hide-el right-border" data-field="access_policy">
				<select name="access_policy">
					<option value="PUBLIC">PUBLIC</option>
					<option value="PRIVATE">PRIVATE</option>
				</select>
			</td>

			<!-- Advance -->
			<td class="hide-el" data-field="readinglevel"></td>
			<td class="hide-el" data-field="timerequired"></td>
			<td class="hide-el" data-field="textcomplexity" class="right-border">
				<select name="textcomplexity">
					<option value="None">None</option>
				{% for each_tc in static_textcomplexity %}		
					<option {%if each_tc == resource.textcomplexity %}selected="selected"{%endif%} value="{{ each_tc }}">{{ each_tc }}</option>
				{% endfor %}	
				</select>				
			</td>
		</tr>

		{% endfor %}
	</tbody>
</table>

<!-- END of Looping through each resource -->

{% endblock %}

<!-- Pagination -->
{% block data_review_pagination %}

	{% if page_info.num_pages > 1 %}

		<div class="pagination-centered">
			<ul class="pagination" role="menubar" aria-label="Pagination">
				
				{% if page_info.num_pages < 11 %}
				

					{% for each_page in page_info.page_range %}

						{% if page_info.current_page == each_page %}
						<li class="current">
						{% else %}
						<li>
						{% endif %}
							<a href="{% url 'data_review_page' group_name_tag each_page %}"> {{ each_page }} </a>
						</li>

					{% endfor %}
				
				{% else %}

					{% if page_info.has_previous %}

						<!-- for  << previous  text -->
						<li class="arrow">
							<a href="{% url 'data_review_page' group_name_tag page_info.previous_page %}">&laquo; Previous</a>
						</li>

						<!-- for page 1, page 2 and ... -->
						{% if page_info.previous_page|add:"-2" != 1 and page_info.previous_page|add:"-2" > 0 %}
							<li><a href="{% url 'data_review_page' group_name_tag 1 %}">1</a></li>
							<li><a href="{% url 'data_review_page' group_name_tag 2 %}">2</a></li>
							<li class="unavailable" aria-disabled="true"><span class="subheader">&hellip;</span></li>
						{% endif %}
			
						<!-- for previous page -->
						<li>
							<a href="{% url 'data_review_page' group_name_tag page_info.previous_page %}">
								{{ page_info.previous_page }}
							</a>
						</li>
					{% endif %}

					<!-- for current page -->
					<li class="current"><a href="">{{ page_info.current_page }}</a></li>
					

					{% if page_info.has_next %}

						<!-- for next page -->
						<li>
							<a href="{% url 'data_review_page' group_name_tag page_info.next_page %}">
								{{ page_info.next_page }}
							</a>
						</li>
						{% if page_info.next_page != page_info.num_pages %}
							
							{% if page_info.next_page != page_info.num_pages|add:"-1" %}

								<!-- for .... -->
								{% if page_info.next_page != page_info.num_pages|add:"-2" %}
									<li class="unavailable" aria-disabled="true"><span class="subheader">&hellip;</span></li>
								{% endif %}
				
								<!-- for secondlast page -->
								<li>
									<a href="{% url 'data_review_page' group_name_tag page_info.num_pages|add:'-1' %}">
										{{ page_info.num_pages|add:"-1" }}
									</a>
								</li>
							{% endif %}
							
							<!-- for last page -->
							<li>
								<a href="{% url 'data_review_page' group_name_tag page_info.num_pages %}">
									{{ page_info.num_pages }}
								</a>
							</li>
						{% endif %}

						<!-- for text Next >> -->
						<li class="arrow">
							<a href="{% url 'data_review_page' group_name_tag page_info.next_page %}">Next &raquo;</a>
						</li>
				
					{% endif %}

				{% endif %}
			</ul>
		</div>

	{% endif %}
{% endblock %}
<!-- -END of Pagination -->


{% block script %}
// <script type="text/javascript">
	
	isFieldEdited = false;

	// removing left panel:
	$("main.row > aside.columns").detach();

	// making body_content block to take 12-large columns
	$article = $("main.row > article.columns");
	$article.removeClass("medium-10").addClass("large-12");
	$article.css("overflow-x", "scroll");


	// action on edit click:
	function editResRow(oid)
	{

		$("div[data-id='edit-btn-" + oid +"']").fadeOut(0);

		// fetching resource object edit row
		var $resEditRow = $("tr#edit-row-" + oid),
			resEditRowArr = $resEditRow.children();

		// processing each element of row
		for (var i = 0; i < resEditRowArr.length; i++)
		{
			resEditRowArr[i].classList.remove("hide-el");
		};
		
		$("div[data-id='save-cancel-div-" + oid +"']").fadeIn(800);
		// resRowArr.each(function(i){
		// 	console.log(this)
		// })

	}

	// action on cancel button click
	function CancelEditResRow(oid)
	{

		// fetching resource object view row
		var $resViewRow = $("tr#view-row-" + oid),
			resViewRowArr = $resViewRow.children();

		// fetching resource object edit row
		var $resEditRow = $("tr#edit-row-" + oid);
			resEditRowArr = $resEditRow.children();

		// processing each element of row
		for (var i = 1; i < resEditRowArr.length; i++)
		{

			// checking if the values in textboxes are changed
			if(resEditRowArr[i].firstElementChild)
			{
				if((resEditRowArr[i].firstElementChild.type == "text") || (resEditRowArr[i].firstElementChild.type == "select-one"))
				{
					isFieldEdited = resViewRowArr[4+0].textContent.trim() == resEditRowArr[5+0].firstElementChild.value.trim()? false: true;
				}
			}

			// resEditRowArr[i].classList.add("hide-el");
		};

		$("div[data-id='save-cancel-div-" + oid +"']").fadeOut(0);
		$("div[data-id='edit-btn-" + oid +"']").fadeIn(800);
	}

// </script>
{% endblock %}