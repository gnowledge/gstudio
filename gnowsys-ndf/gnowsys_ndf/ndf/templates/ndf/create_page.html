{% extends "ndf/base.html" %}

<!-- //////////////////////////////////////////////////////////////////////////////////////////////// -->

{% block head %}
	
<!-- orgitdown! -->
<script type="text/javascript" src="/static/ndf/orgitdown/jquery.orgitdown.js"></script>
<!-- orgitdown! toolbar settings -->
<script type="text/javascript" src="/static/ndf/orgitdown/sets/org/set.js"></script>
<!-- orgitdown! skin -->
<link rel="stylesheet" type="text/css" href="/static/ndf/orgitdown/skins/orgitdown/style.css" />
<!--  orgitdown! toolbar skin -->
<link rel="stylesheet" type="text/css" href="/static/ndf/orgitdown/sets/org/style.css" />

{% endblock %}

<!-- //////////////////////////////////////////////////////////////////////////////////////////////// -->

{% block title %} Wikipage {% endblock %}

<!-- //////////////////////////////////////////////////////////////////////////////////////////////// -->

{% block body_content %} 

<div style="display:inline-block; float:left; padding-top:40px; ">
<form method="post" action="{% url 'create_page' %}">
  {% csrf_token %}
  
  <div style='display:table; '>	
    
    <div style='display:table-row;'>			
      <div style='display:table-cell;'>	Name	</div>
      <div style='display:table-cell; padding-left:20px;'>	
	      <input type="text" id="page_name_id" name="page_name" autofocus="autofocus" placeholder="Enter title">	
      </div>
    </div>	
    <br/>
    <div style='display:table-row;'>
      <div style='display:table-cell;'>	Tags 	</div>
      <div style='display:table-cell; padding-left:20px;'>	
	      <input type="text" name="page_tags" placeholder="Example: abc, XYZ">	 
	    </div>
    </div>		

  </div>
  
  <!--      Collection part                       -->
    
    <br/>
    
    <div>
      <input type="checkbox" name="private" id="private" />&nbsp;Private 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <input type="checkbox" id="coll" name="collection" />&nbsp;Collection<br/>

      <div id="drawertable" style="display:none">
      <table style="width:370px;" >
	<tr>
          <td style='width:160px;'>
	    <b>Pages:</b><br/>
	    <select multiple="multiple" id='lstBox1'>    <!---->
	      {% for key,value in drawer1.items %}
	      <option id={{key}}>{{value}}</option>
	      {% endfor %}
	    </select>
	  </td>
	  <td style='width:50px;text-align:center;vertical-align:middle;'>
	    <input type='button' id='btnUp' value ='  ^  '><br/>
	    <input type='button' id='btnRight' value ='  >  '><br/>
	    <input type='button' id='btnLeft' value ='  <  '><br/>
		   <input type='button' id='btnDown' value ='  v  '><br/>
		   
	  </td>

	  <td style='width:160px;'>
            <b>Added to Drawer: </b><br/>
	    
            <select multiple="multiple" name="lstb2" id='lstBox2'>
	      
            </select>
	  </td><br>
	</tr>

      </table>
      </div>
	      
    </div><br/> 

    
    <!--                             -->
  
  <div id="text-editor" style="display:inline-block; float:left; padding-top:10px">
    <textarea id="orgitdown" name="content_org" disabled> </textarea>
  </div>

  <br/>

  <div style="display:inline-block; padding-top:10px">
  <input type="hidden" id="usrid_id" name="usrid" value={{user.id}} />
  <input type="hidden" id="usrname_id" name="usrname" value={{user.username}} />
  <input type="hidden" id="collection-list" name="collection-list" value="" />  
  <input type="submit" id="save-page" value="Save" class="btn btn-large btn-primary" disabled>
  </div>
  
</div>

</form>

<!-- //////////////////////////////////////////////////////////////////////////////////////////////// -->

<!--                    -->


<script type="text/javascript">
    var arr = [];

 $(function()
 {
   $("#coll").change(function()
   {     
      if (this.checked){
        $("#drawertable").css("display", "block")
        //$("#lstvalue").css("display", "block")
        $("#resetdrawer").css("display", "block")  
        
      }
      else{
        $("#drawertable").css("display", "none")
        //$("#lstvalue").css("display", "none")
        $("#resetdrawer").css("display", "none")
       
      }
   });
 
   $("#btnRight").click(function() { 
       var selectedOpts = $("#lstBox1 option:selected");
       if (selectedOpts.length == 0){
           alert("Nothing to move.");
           e.preventDefault();
       }
       $("#lstBox2").append($(selectedOpts).clone());
       $(selectedOpts).remove();
       e.preventDefault();

   });   
   
   $("#btnUp").click(function() {
       
      $("#lstBox1 :selected").each(function (i, selected) {
            $(this).insertBefore($(this).prev());
	    $("#lstbox2").options.att("selected",false);
      });
      $("#lstBox1 select").focus().blur();
      $("#lstBox2 :selected").each(function (i, selected) {
            $(this).insertBefore($(this).prev());
	    $("#lstbox1").options.att("selected",false);
      });
      $("#lstBox2 select").focus().blur();
   });

    $("#btnDown").click(function() {
      $("#lstBox1 :selected").each(function (i, selected) {
            $(this).insertAfter($(this).next());
	    $("#lstbox2").options.att("selected",false);	
      });
      $("#lstBox1 select").focus().blur();
      $("#lstBox2 :selected").each(function (i, selected) {
            $(this).insertAfter($(this).next());
	    $("#lstbox1").options.att("selected",false);
      });
      $("#lstBox2 select").focus().blur();
 
    });
    
    $("#btnLeft").click(function() {
      var selectedOpts = $("#lstBox2 option:selected");
        if (selectedOpts.length == 0) {
            alert("Nothing to move.");
            e.preventDefault();
        }

        $("#lstBox1").append($(selectedOpts).clone());
        $(selectedOpts).remove();
        e.preventDefault();
    });

    $("#resetdrawer").click(function(){
        $("#lstBox2").empty();

    });

    $("#save-page").click(function(){
        opts = lstBox2.options, len = opts.length;

        save_enabled = $("#save-page").attr("disabled")

        if (len > 0 && save_enabled != "disabled") 
        {
          var arr = [];
          
          for (var i = 0; i < len; i++) {
		        arr[i] = "'"+opts[i].value+"'";
	        }
	        
	        var abc=arr.join(',');
	        $("#collection-list").val(abc)
	      }
    });
 
 });


  $(document).ready(function()
  {
    $("#page_name_id").change(function() { 
      if($.trim(this.value).length > 0)
      {	
        $("#orgitdown").val("")		
        $("#orgitdown").attr("placeholder", "Please enter some content as description...")
        $("#orgitdown").removeAttr("disabled");
        $("#save-page").removeAttr("disabled");
      }
      else
      {
        $("#save-page").attr("disabled", "disabled");
        $("#orgitdown").attr("disabled", "disabled");
      }
    });
    
    $("#orgitdown").orgitdown(mySettings);
  });
  
</script>

{% endblock %}

