{% load i18n %}
{% load ndf_tags %}
{% check_is_gstaff group_id request.user as is_gstaff %}
            
            <div class="task_editor_top">
            </div>
            <div class="row task_head">
                <div class="large-2 columns left ">
                    All Tasks
                </div>
                <div class="large-2 columns right">
                    <a href="#"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></a>
                </div>
            </div>
            
            {% for each in TASK_inst %}
              <ul class="inline-list task_ex">
                 <div class="{{each.id}}">
                  <li class="large-5 columns">
                        <form>
                            <input type="checkbox" name="task" value="task" style="margin-right: 5px;"> {{each.Name}} 
                        </form>
                  </li>
                  <li class="large-1 columns">
                        <a href="#" style="color: black;">{{each.Assignee.0}}</a>
                  </li>
                  <li class="large-2 columns">
                    <div class="small-2 columns">
                        <a href="#" style="color: black;" class="circle-{{each.Priority|lower}}"></a>
                    </div>
                    <div class="small-9 columns priority-margin">
                    {{each.Priority}}
                    </div>
                  </li>
                  <li>
                    <a class="status-indication" title="completed">{{each.Status}}</a>
                  </li>
                  <li><a href="#" class="iconclr"><i class="fa fa-pencil "></i></a></li>
                  {% if each.owner == 'owner'  or is_gstaff %}
                  <li class="delete-task"><a  class="iconclr" onclick="deleteTask('{{each.id}}')"><i class="fa fa-trash " ></i></a></li>
                  {% endif %}
                  </div>
              </ul>
            {% endfor %}


            <script type="text/javascript">
        
           function deleteTask(task_id){

                if (confirm("Do you want to delete this task?.") == true){
                    //url = "/" + "{{group_id}}" + "/" + "gtask/gdelete_task/" + task_id
                    $.ajax({
                        url: "{% url 'ajax_delete_node' group_id  %}",
                        type: "POST",
                        data: {
                          'csrfmiddlewaretoken': "{{csrf_token}}",
                          "node_to_delete": task_id,
                          "deletion_type": 0,
                          "right_subject": 1,

                        },
                        
                        success: function(data){ 
                        node_id = JSON.parse(data)
                        alert("Deleted task successfully");
                        $('.' +node_id['node_id'] ).remove();
                        
                        },
                        
                        complete: function(){
                          // $('#Student').foundation('reveal', 'open');
                        }
                    });
                
                }
                else{

                }
            }

            </script>